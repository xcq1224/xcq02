{"version":3,"sources":["webpack:///src/page/contacts.vue","webpack:///./src/page/contacts.vue?b386","webpack:///./src/page/contacts.vue"],"names":["contacts","required","message","trigger","validator","callback","getContacts","_this","this","selectedOptions","list","_this2","_this3","customers","resetFields","click","_this4","focus","inputValue","_this5","dynamicTags","FormData","imgSrc","contactsAdd","_this6","selectValue","then","id","val","page_contacts","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","label-position","size","inline","model","dsQuery","label-width","label","clearable","placeholder","value","$$v","$set","expression","_v","type","on","$event","query_show","class","directives","name","rawName","staticStyle","width","margin-right","start-placeholder","end-placeholder","value-format","default-time","addcontats","deleteCrmContacts","margin-top","data","slice","currentPage","pagesize","max-height","border","default-sort","prop","order","selection-change","handleSelectionChange","scopedSlots","_u","key","fn","scope","to","row","_s","createTime","split","float","background","layout","page-size","current-page","total","length","current-change","handleCurrentChange","title","visible","dialogAddVisible","close-on-click-modal","update:visible","open","openModal","close","closeModal","ref","rules","contacts_rules","chooseImg","src","getUrl","alt","accept","change","pictureChange","filterable","_l","item","index","editorType","_e","tag","closable","disable-transitions","handleClose","blur","handleInputConfirm","nativeOn","keyup","_k","keyCode","showInput","slot","contactsSave","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/33.9319fce0184de169e916.js","sourcesContent":["<template>\n\n  <div class=\"wrap\">\n    \n     <!--查询表单-->\n    <el-form label-position=\"left\" size=\"small\" :inline=\"true\" :model=\"dsQuery\" label-width='70px' class=\"query-form\">\n      <el-form-item label=\"姓名\">\n        <el-input v-model=\"dsQuery.name\" clearable placeholder=\"\"></el-input>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"getContacts()\">查询</el-button>\n      </el-form-item>\n      <el-form-item>\n        &nbsp;&nbsp;&nbsp;&nbsp;<a class=\"text-base\" @click='query_show = !query_show; '>更多查询条件<i :class=\"'iconfont icon-'+query_show\"></i></a>\n      </el-form-item>\n      <div v-show=\"query_show\">\n        <div class=\"input-box\">\n          <el-form-item label=\"客户名称\">\n            <el-input v-model=\"dsQuery.customerName\" placeholder=\"\" clearable></el-input>\n          </el-form-item>\n          <el-form-item label=\"手机号\">\n            <el-input v-model=\"dsQuery.mobilePhone\" placeholder=\"\" clearable></el-input>\n          </el-form-item>\n          <el-form-item label=\"创建时间\">\n              <el-date-picker\n                  v-model=\"dsQuery.createTime\"\n                  type=\"daterange\"\n                  style=\"width: 250px; margin-right: 30px;\"\n                  start-placeholder=\"开始日期\"\n                  end-placeholder=\"结束日期\"\n                  value-format=\"yyyy-MM-dd\"\n                  :default-time=\"['00:00:00', '23:59:59']\">\n              </el-date-picker>\n          </el-form-item>\n        </div>\n      </div>\n\n    </el-form>\n    <!--操作按钮-->\n    <el-row>\n      <el-button type=\"primary\" size=\"small\" @click=\"addcontats()\">新增</el-button>\n      <!-- <el-button type=\"primary\" size=\"small\" @click=\"test()\">导入</el-button> -->\n      <el-button type=\"primary\" size=\"small\" @click=\"deleteCrmContacts()\">删除</el-button>\n      <!-- <el-button type=\"primary\" size=\"small\" @click=\"dialogMergeVisible = true\">转给他人</el-button>\n      <el-button type=\"primary\" size=\"small\" @click=\"dialogTransferVisible = true\">扫描名片</el-button> -->\n    </el-row>\n\n    <!--联系人表格数据展示-->\n    <el-table class=\"table\" :data=\"contacts.slice((currentPage-1)*pagesize,currentPage*pagesize)\"\n               max-height=\"500\" border style=\"width: 100%; margin-top: 20px;\"\n               @selection-change=\"handleSelectionChange\"\n               :default-sort=\"{prop: 'name', order: 'filed_must_creatTime'}\">\n      <el-table-column type=\"selection\" width=\"40\"></el-table-column>\n      <el-table-column prop=\"name\" label=\"姓名\">\n        <template slot-scope=\"scope\">\n          <router-link class=\"text-base\" :to=\"'./contacts_detail?id=' + scope.row.id\">{{scope.row.name}}</router-link>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"customerName\"  label=\"客户名称\"></el-table-column>\n      <el-table-column prop=\"job\" label=\"职务\"></el-table-column>\n      <el-table-column prop=\"dept\" label=\"部门\"></el-table-column>\n      <el-table-column prop=\"mobilePhone\" label=\"手机号\"></el-table-column>\n      <el-table-column prop=\"business\" label=\"负债业务\"></el-table-column>\n      <el-table-column prop=\"createTime\" label=\"创建时间\">\n        <template slot-scope=\"scope\">\n          {{scope.row.createTime.split(' ')[0]}}\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <br/>\n    <!--分页-->\n    <el-pagination background layout=\"total,prev, pager, next\"\n                   :page-size=\"pagesize\"\n                   @current-change=\"handleCurrentChange\"\n                   :current-page=\"currentPage\"\n                   :total=\"contacts.length\" style=\"float: right;\">\n    </el-pagination>\n\n\n    <!--新增联系人弹框-->\n    <el-dialog title=\"新增联系人\" width=\"600px\" class=\"dialogAdd\"\n               :visible.sync=\"dialogAddVisible\" @open=\"openModal\" @close=\"closeModal\" :close-on-click-modal='false'>\n\n      <el-form ref=\"form\" :model=\"contactsAdd\" :rules=\"contacts_rules\" label-position=\"left\" label-width=\"120px\" size=\"small\">\n        <el-form-item label=\"照片\">\n          <div class=\"upload-box\" @click=\"chooseImg\">\n            <i v-show=\"!imgSrc\" class=\"el-icon-plus\"></i>\n            <img v-show=\"imgSrc\" :src=\"getUrl(imgSrc)\" alt=\"\">\n            <input type=\"file\" @change=\"pictureChange\" v-show=\"false\" ref=\"uploadInput\" accept=\"image/*\">\n          </div>\n        </el-form-item>\n        <el-form-item  label=\"客户名称\" prop=\"customerName\">\n          <el-select v-model=\"contactsAdd.customerName\" size=\"small\" filterable clearable placeholder=\"请输入客户名称\">\n            <el-option\n              v-for=\"item in customers\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.name + '/' + item.id\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item v-for=\"(item,index) in contactsAddLabel\" :key=\"index\" :prop=\"item.name\" :label=\"item.label\">\n          <el-input v-if=\"item.editorType == 'text'\" v-model=\"contactsAdd[item.name]\"></el-input>\n          <el-date-picker v-if=\"item.editorType == 'date'\" v-model=\"contactsAdd[item.name]\" value-format=\"yyyy-MM-dd\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\n\n          <el-select v-if=\"item.editorType == 'dict'\" v-model=\"contactsAdd[item.name]\">\n            <el-option\n              v-if=\"item.editorType == 'dict'\"\n              v-for=\"value in item.selectList\"\n              :key=\"value\"\n              :label=\"value\"\n              :value=\"value\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"标签\">\n          <el-tag\n            :key=\"tag\"\n            v-for=\"tag in dynamicTags\"\n            closable\n            :disable-transitions=\"false\"\n            @close=\"handleClose(tag)\">\n            {{tag}}\n          </el-tag>\n          <el-input\n            class=\"input-new-tag\"\n            v-if=\"inputVisible\"\n            v-model=\"inputValue\"\n            ref=\"saveTagInput\"\n            size=\"small\"\n            @keyup.enter.native=\"handleInputConfirm\"\n            @blur=\"handleInputConfirm\"\n          >\n          </el-input>\n          <el-button v-else class=\"button-new-tag\" size=\"small\" @click=\"showInput\">+ New Tag</el-button>\n        </el-form-item>\n      </el-form>\n\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogAddVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"contactsSave()\">确 定</el-button>\n      </div>\n\n    </el-dialog>\n\n\n\n  </div>\n</template>\n\n<script>\n  import {\n\n    mapState,\n\n    mapActions,\n\n    mapMutations\n\n  } from 'vuex'\n\n  export default {\n\n    data() {\n      //  验证手机号\n      var checkPhone = function(rule, value, callback){\n        let reg = /^1[0-9]{10}$/;\n        if(reg.test(value)){\n          callback()\n        }else{\n          callback(new Error('手机号错误!'))\n        }\n      };\n\n      return {\n        customers: [],    //  所有客户\n        customer: '',     //  客户（客户id + 客户姓名）\n        imgSrc: '', //  联系人头像\n        dynamicTags: [],        //  tag标签集合\n        inputVisible: false,    //  是否显示编辑tag的input框\n        inputValue: '',         //  新增标签input值\n        contactsAddLabel: [],   //  新增客户label\n        contactsAdd:{},         //  联系人新增对象\n        contacts_rules: {\n          customerName: [\n            { required: true, message: '请选择客户', trigger: 'change' },\n          ],\n          name: [\n            { required: true, message: '请输入联系人姓名', trigger: 'blur' },\n          ],\n          mobilePhone: [\n            { required: true, message: '请输入手机号', trigger: 'blur' },\n            { validator: checkPhone, trigger: 'blur' }\n          ]\n        }, //  新增联系人验证规则\n        \n\n\n\n\n\n\n\n        dsQuery: {},    //  查询条件\n        query_show: false,          //  是否显示更多查询\n        contacts: [],//联系人table数据\n        dialogAddVisible: false,//弹框是否显示\n        savaflag :'',//操作标识符\n        selectValue:[],//勾选的数据\n        currentPage: 1,//默认开始页面\n        pagesize: 20,//每页的数据条数\n        \n\n      }\n\n    },\n    activated() {\n\n      this.getContacts();\n    },\n\n    methods: {\n      //  获取联系人列表\n      getContacts(){\n        console.log(this.selectedOptions)\n        this.$post(\"/crm/contactsPR/queryCrmContacts\", this.dsQuery, (data) => {\n          this.contacts = data.list;\n        })\n      },\n\n\n      /**------------------------------------------新增联系人选择头像------------------------------------------ */\n      //  新增按钮\n      addcontats() {\n        this.$post(\"/crm/extFieldPR/getField\", {tableName: 'crm_contacts'}, (data) => {\n          this.contactsAddLabel = data.list;\n          data.list.map((item) => {\n            if (item.editorType == 'cascade' & !item.value){\n              this.contactsAdd[item.name] = []\n            }\n          })\n          this.dialogAddVisible = true;\n        })\n      },\n      //  打开新增模态框\n      openModal(){\n        if(!this.customers.length){\n          this.$post(\"/crm/queryAllCustomers\", {}, (data) => {\n            this.customers = data.customers\n          })\n        }\n      },\n      //  关闭新增模态框，清除数据\n      closeModal(){\n        this.dynamicTags = []\n        this.imgSrc = ''\n        this.$refs.uploadInput.value = ''\n        this.$refs.form.resetFields();\n      },\n      //  打开input file\n      chooseImg(){\n        this.$refs.uploadInput.click()\n      },\n      //  选择图片\n      pictureChange(e){\n        if(e.target.files.length) this.imgSrc = e.target.files[0]\n      },\n      //  添加标签\n      handleClose(tag) {\n        this.dynamicTags.splice(this.dynamicTags.indexOf(tag), 1);\n      },\n      //  添加标签\n      showInput() {\n        this.inputVisible = true;\n        this.$nextTick(_ => {\n          this.$refs.saveTagInput.$refs.input.focus();\n        });\n      },\n      //  添加标签\n      handleInputConfirm() {\n        let inputValue = this.inputValue;\n        if (inputValue) {\n          this.dynamicTags.push(inputValue);\n        }\n        this.inputVisible = false;\n        this.inputValue = '';\n      },\n      //  保存数据\n      contactsSave() {\n        this.$refs.form.validate((valid) => {\n          if (valid) {\n            this.contactsAdd.customerId = this.contactsAdd.customerName.split(\"/\")[1]\n            this.contactsAdd.customerName = this.contactsAdd.customerName.split(\"/\")[0]\n            this.contactsAdd.tags = this.dynamicTags\n            let params = new FormData()\n            params.append('avatar', this.imgSrc)\n            params.append('contactsAdd', JSON.stringify(this.contactsAdd))\n            this.$post(\"/crm/contactsPR/addCrmContacts\", params, (data) => {\n              this.$notify.success({ message: '操作成功！'});\n              this.getContacts();\n              this.dialogAddVisible = false;\n            })\n          }\n        });\n      },\n      \n\n      //  删除按钮\n      deleteCrmContacts() {\n        let that = this\n        var select_value = this.selectValue;\n        if (select_value.length < 1) {\n          this.$notify.warning({ message: '请勾选数据！'});\n          return;\n        };\n        this.$confirm('确定删除?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          let list = []\n          this.selectValue.map(item => {\n            list.push(item.id)\n          })\n          this.$post('/crm/contactsPR/deleteCrmContacts', {\"list\": list}, (data) => {\n            this.$message.success('操作成功！');\n            this.getContacts();\n          });\n        });\n      },\n\n\n      //  勾选的数据\n      handleSelectionChange(val) {\n         this.selectValue = val;\n      },\n      //  分页\n      handleCurrentChange(val){\n        this.currentPage = val;\n      },\n    },\n  }\n</script>\n<style lang=\"less\" scoped>\n  .el-tag + .el-tag {\n    margin-left: 10px;\n    margin-bottom: 10px;\n  }\n  .button-new-tag {\n    margin-left: 10px;\n    height: 32px;\n    line-height: 30px;\n    padding-top: 0;\n    padding-bottom: 0;\n  }\n  .input-new-tag {\n    width: 90px !important;\n    margin-left: 10px;\n    vertical-align: bottom;\n  }\n  .query-form{\n    .el-input, .el-select, .el-date-picker{\n        width: 250px;\n        margin-right: 30px;\n    }\n  }\n  .dialogAdd {\n    .el-input, .el-cascader, .el-select, .el-textarea {\n      width: 400px;\n    }\n    .upload-box{\n      border: 1px solid #ddd;\n      width: 60px;\n      height: 60px;\n      text-align: center;\n      cursor: pointer;\n      i{\n        font-size: 30px;\n        line-height: 60px;\n        color: #ddd;\n      }\n      img{\n        max-width: 100%;\n        max-height: 100%;\n      }\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/page/contacts.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrap\"},[_c('el-form',{staticClass:\"query-form\",attrs:{\"label-position\":\"left\",\"size\":\"small\",\"inline\":true,\"model\":_vm.dsQuery,\"label-width\":\"70px\"}},[_c('el-form-item',{attrs:{\"label\":\"姓名\"}},[_c('el-input',{attrs:{\"clearable\":\"\",\"placeholder\":\"\"},model:{value:(_vm.dsQuery.name),callback:function ($$v) {_vm.$set(_vm.dsQuery, \"name\", $$v)},expression:\"dsQuery.name\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.getContacts()}}},[_vm._v(\"查询\")])],1),_vm._v(\" \"),_c('el-form-item',[_vm._v(\"\\n          \"),_c('a',{staticClass:\"text-base\",on:{\"click\":function($event){_vm.query_show = !_vm.query_show;}}},[_vm._v(\"更多查询条件\"),_c('i',{class:'iconfont icon-'+_vm.query_show})])]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.query_show),expression:\"query_show\"}]},[_c('div',{staticClass:\"input-box\"},[_c('el-form-item',{attrs:{\"label\":\"客户名称\"}},[_c('el-input',{attrs:{\"placeholder\":\"\",\"clearable\":\"\"},model:{value:(_vm.dsQuery.customerName),callback:function ($$v) {_vm.$set(_vm.dsQuery, \"customerName\", $$v)},expression:\"dsQuery.customerName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"手机号\"}},[_c('el-input',{attrs:{\"placeholder\":\"\",\"clearable\":\"\"},model:{value:(_vm.dsQuery.mobilePhone),callback:function ($$v) {_vm.$set(_vm.dsQuery, \"mobilePhone\", $$v)},expression:\"dsQuery.mobilePhone\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"创建时间\"}},[_c('el-date-picker',{staticStyle:{\"width\":\"250px\",\"margin-right\":\"30px\"},attrs:{\"type\":\"daterange\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\",\"value-format\":\"yyyy-MM-dd\",\"default-time\":['00:00:00', '23:59:59']},model:{value:(_vm.dsQuery.createTime),callback:function ($$v) {_vm.$set(_vm.dsQuery, \"createTime\", $$v)},expression:\"dsQuery.createTime\"}})],1)],1)])],1),_vm._v(\" \"),_c('el-row',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){_vm.addcontats()}}},[_vm._v(\"新增\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){_vm.deleteCrmContacts()}}},[_vm._v(\"删除\")])],1),_vm._v(\" \"),_c('el-table',{staticClass:\"table\",staticStyle:{\"width\":\"100%\",\"margin-top\":\"20px\"},attrs:{\"data\":_vm.contacts.slice((_vm.currentPage-1)*_vm.pagesize,_vm.currentPage*_vm.pagesize),\"max-height\":\"500\",\"border\":\"\",\"default-sort\":{prop: 'name', order: 'filed_must_creatTime'}},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"40\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"姓名\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('router-link',{staticClass:\"text-base\",attrs:{\"to\":'./contacts_detail?id=' + scope.row.id}},[_vm._v(_vm._s(scope.row.name))])]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"customerName\",\"label\":\"客户名称\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"job\",\"label\":\"职务\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"dept\",\"label\":\"部门\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"mobilePhone\",\"label\":\"手机号\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"business\",\"label\":\"负债业务\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"createTime\",\"label\":\"创建时间\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n        \"+_vm._s(scope.row.createTime.split(' ')[0])+\"\\n      \")]}}])})],1),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('el-pagination',{staticStyle:{\"float\":\"right\"},attrs:{\"background\":\"\",\"layout\":\"total,prev, pager, next\",\"page-size\":_vm.pagesize,\"current-page\":_vm.currentPage,\"total\":_vm.contacts.length},on:{\"current-change\":_vm.handleCurrentChange}}),_vm._v(\" \"),_c('el-dialog',{staticClass:\"dialogAdd\",attrs:{\"title\":\"新增联系人\",\"width\":\"600px\",\"visible\":_vm.dialogAddVisible,\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.dialogAddVisible=$event},\"open\":_vm.openModal,\"close\":_vm.closeModal}},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.contactsAdd,\"rules\":_vm.contacts_rules,\"label-position\":\"left\",\"label-width\":\"120px\",\"size\":\"small\"}},[_c('el-form-item',{attrs:{\"label\":\"照片\"}},[_c('div',{staticClass:\"upload-box\",on:{\"click\":_vm.chooseImg}},[_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.imgSrc),expression:\"!imgSrc\"}],staticClass:\"el-icon-plus\"}),_vm._v(\" \"),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.imgSrc),expression:\"imgSrc\"}],attrs:{\"src\":_vm.getUrl(_vm.imgSrc),\"alt\":\"\"}}),_vm._v(\" \"),_c('input',{directives:[{name:\"show\",rawName:\"v-show\",value:(false),expression:\"false\"}],ref:\"uploadInput\",attrs:{\"type\":\"file\",\"accept\":\"image/*\"},on:{\"change\":_vm.pictureChange}})])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"客户名称\",\"prop\":\"customerName\"}},[_c('el-select',{attrs:{\"size\":\"small\",\"filterable\":\"\",\"clearable\":\"\",\"placeholder\":\"请输入客户名称\"},model:{value:(_vm.contactsAdd.customerName),callback:function ($$v) {_vm.$set(_vm.contactsAdd, \"customerName\", $$v)},expression:\"contactsAdd.customerName\"}},_vm._l((_vm.customers),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name,\"value\":item.name + '/' + item.id}})}))],1),_vm._v(\" \"),_vm._l((_vm.contactsAddLabel),function(item,index){return _c('el-form-item',{key:index,attrs:{\"prop\":item.name,\"label\":item.label}},[(item.editorType == 'text')?_c('el-input',{model:{value:(_vm.contactsAdd[item.name]),callback:function ($$v) {_vm.$set(_vm.contactsAdd, item.name, $$v)},expression:\"contactsAdd[item.name]\"}}):_vm._e(),_vm._v(\" \"),(item.editorType == 'date')?_c('el-date-picker',{attrs:{\"value-format\":\"yyyy-MM-dd\",\"type\":\"date\",\"placeholder\":\"选择日期\"},model:{value:(_vm.contactsAdd[item.name]),callback:function ($$v) {_vm.$set(_vm.contactsAdd, item.name, $$v)},expression:\"contactsAdd[item.name]\"}}):_vm._e(),_vm._v(\" \"),(item.editorType == 'dict')?_c('el-select',{model:{value:(_vm.contactsAdd[item.name]),callback:function ($$v) {_vm.$set(_vm.contactsAdd, item.name, $$v)},expression:\"contactsAdd[item.name]\"}},_vm._l((item.selectList),function(value){return (item.editorType == 'dict')?_c('el-option',{key:value,attrs:{\"label\":value,\"value\":value}}):_vm._e()})):_vm._e()],1)}),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"标签\"}},[_vm._l((_vm.dynamicTags),function(tag){return _c('el-tag',{key:tag,attrs:{\"closable\":\"\",\"disable-transitions\":false},on:{\"close\":function($event){_vm.handleClose(tag)}}},[_vm._v(\"\\n          \"+_vm._s(tag)+\"\\n        \")])}),_vm._v(\" \"),(_vm.inputVisible)?_c('el-input',{ref:\"saveTagInput\",staticClass:\"input-new-tag\",attrs:{\"size\":\"small\"},on:{\"blur\":_vm.handleInputConfirm},nativeOn:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.handleInputConfirm($event)}},model:{value:(_vm.inputValue),callback:function ($$v) {_vm.inputValue=$$v},expression:\"inputValue\"}}):_c('el-button',{staticClass:\"button-new-tag\",attrs:{\"size\":\"small\"},on:{\"click\":_vm.showInput}},[_vm._v(\"+ New Tag\")])],2)],2),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogAddVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.contactsSave()}}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-41f94e58\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/page/contacts.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-41f94e58\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./contacts.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./contacts.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./contacts.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-41f94e58\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./contacts.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-41f94e58\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/page/contacts.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}