webpackJsonp([10],{DlYU:function(e,t){},vgMc:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("NYxO");var l=a("Wxq9"),r={data:function(){return{hzzt:[],hzfs:[],tableData:[],addLabel:[],allStaff:[],addForm:{area:[]},rules:{name:[{required:!0,message:"请选择客户",trigger:"blur"}],phone:[{required:!0,message:"请输入电话",trigger:"blur"}],ownerCname:[{required:!0,message:"请选择拥有者",trigger:"change"}]},options:l.regionData,dsQuery:{name:"",cooperationStatus:"",cooperationType:"",phone:"",classify:"",lastFollowTime:[]},query_show:!1,dialogAddVisible:!1,selectValue:[],currentPage:1,pagesize:20,dialogTransferVisible:!1,staff:"",formTransfer:{checkbox1:!1,checkbox2:!1,checkbox3:!1}}},mounted:function(){var e=this;this.$post("/crm/getDict",{list:["crm-hzzt","crm-hzfs"]},function(t){e.hzzt=t["crm-hzzt"],e.hzfs=t["crm-hzfs"]})},activated:function(){this.getData()},methods:{getData:function(){var e=this;this.$post("/crm/partnerPR/getAll",this.dsQuery,function(t){e.tableData=t.list})},addOpen:function(){this.dialogAddVisible=!0,this.getAllStaff()},getAllStaff:function(){var e=this;this.allStaff.length||this.$post("/crm/getAllStaff",{},function(t){e.allStaff=t.list})},openModal:function(){var e=this;this.addLabel.length||this.$post("/crm/extFieldPR/getField",{tableName:"crm_partner"},function(t){e.addLabel=t.list})},closeModal:function(){this.addForm={area:[]}},addSave:function(){var e=this;this.$refs.addForm.validate(function(t){t&&(e.addForm.ownerId=e.addForm.ownerCname.split("/")[1],e.addForm.ownerCname=e.addForm.ownerCname.split("/")[0],e.$post("/crm/partnerPR/addOne",e.addForm,function(t){e.$notify.success({message:"操作成功！"}),e.getData(),e.dialogAddVisible=!1}))})},turnOther:function(){this.selectValue.length<1?this.$message.error("请勾选数据！"):(this.getAllStaff(),this.dialogTransferVisible=!0)},turn_other_sava:function(){var e=this;if(this.staff){var t=[];this.selectValue.map(function(e){t.push(e.id)});var a={list:t,ownerId:this.staff,ifLeft:this.formTransfer.checkbox1};this.$post("/crm/partnerPR/turnOther",a,function(t){e.dialogTransferVisible=!1,e.$message.success("转移成功！"),e.getData(),e.$refs.table.clearSelection()})}else this.$message.error("请选择新拥有者！")},deleteBtn:function(){var e=this;this.selectValue.length<1?this.$message.error("请勾选数据！"):this._confirm("确定删除吗?",function(){var t=[];e.selectValue.map(function(e){t.push(e.id)}),e.$post("/crm/partnerPR/delete",{list:t},function(t){t.message?e.$message.error(t.message):e.$message.success("删除成功！"),e.$refs.table.clearSelection(),e.getData()})})},handleSelectionChange:function(e){this.selectValue=e},handleCurrentChange:function(e){this.currentPage=e}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrap"},[a("el-form",{staticClass:"query-form",attrs:{"label-position":"left",size:"small",inline:!0,model:e.dsQuery,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{clearable:"",placeholder:""},model:{value:e.dsQuery.name,callback:function(t){e.$set(e.dsQuery,"name",t)},expression:"dsQuery.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getData}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[e._v("\n          "),a("a",{staticClass:"text-base",on:{click:function(t){e.query_show=!e.query_show}}},[e._v("更多查询条件"),a("i",{class:"iconfont icon-"+e.query_show})])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.query_show,expression:"query_show"}]},[a("div",{staticClass:"input-box"},[a("el-form-item",{attrs:{label:"合作状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.dsQuery.cooperationStatus,callback:function(t){e.$set(e.dsQuery,"cooperationStatus",t)},expression:"dsQuery.cooperationStatus"}},e._l(e.hzzt,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"合作方式"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.dsQuery.cooperationType,callback:function(t){e.$set(e.dsQuery,"cooperationType",t)},expression:"dsQuery.cooperationType"}},e._l(e.hzfs,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"电话"}},[a("el-input",{attrs:{placeholder:"",clearable:""},model:{value:e.dsQuery.phone,callback:function(t){e.$set(e.dsQuery,"phone",t)},expression:"dsQuery.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.dsQuery.classify,callback:function(t){e.$set(e.dsQuery,"classify",t)},expression:"dsQuery.classify"}},[a("el-option",{attrs:{value:"1",label:"我拥有的"}}),e._v(" "),a("el-option",{attrs:{value:"2",label:"我参与的"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"跟进时间"}},[a("el-date-picker",{staticStyle:{width:"250px","margin-right":"30px"},attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","default-time":["00:00:00","23:59:59"]},model:{value:e.dsQuery.lastFollowTime,callback:function(t){e.$set(e.dsQuery,"lastFollowTime",t)},expression:"dsQuery.lastFollowTime"}})],1)],1)])],1),e._v(" "),a("el-row",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addOpen}},[e._v("新增")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.deleteBtn}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.turnOther}},[e._v("转给他人")])],1),e._v(" "),a("el-table",{ref:"table",staticClass:"table",staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),"max-height":"500",border:"","default-sort":{prop:"name",order:"creatTime"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{"reserve-selection":!0,type:"selection",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{staticClass:"text-base",attrs:{to:"./partner_detail?id="+t.row.id}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"cooperationStatus",label:"合作状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cooperationType",label:"合作方式"}}),e._v(" "),a("el-table-column",{attrs:{prop:"scale",label:"规模"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"电话"}}),e._v(" "),a("el-table-column",{attrs:{prop:"lastFollowTime",label:"最近跟进时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.lastFollowTime)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"ownerCname",label:"拥有者"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.createTime.split(" ")[0])+"\n      ")]}}])})],1),e._v(" "),a("br"),e._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"total,prev, pager, next","page-size":e.pagesize,"current-page":e.currentPage,total:e.tableData.length},on:{"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{staticClass:"dialogAdd",attrs:{title:"新增合作伙伴",width:"600px",visible:e.dialogAddVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogAddVisible=t},open:e.openModal,close:e.closeModal}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.rules,"label-position":"left","label-width":"120px",size:"small"}},[e._l(e.addLabel,function(t,l){return a("el-form-item",{key:l,attrs:{prop:t.name,label:t.label}},["text"==t.editorType?a("el-input",{attrs:{type:"textarea",resize:"none",autosize:""},model:{value:e.addForm[t.name],callback:function(a){e.$set(e.addForm,t.name,a)},expression:"addForm[item.name]"}}):e._e(),e._v(" "),"date"==t.editorType?a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm",format:"yyyy-MM-dd HH:mm",type:"datetime",placeholder:"选择日期时间"},model:{value:e.addForm[t.name],callback:function(a){e.$set(e.addForm,t.name,a)},expression:"addForm[item.name]"}}):e._e(),"dict"==t.editorType?a("el-select",{model:{value:e.addForm[t.name],callback:function(a){e.$set(e.addForm,t.name,a)},expression:"addForm[item.name]"}},e._l(t.selectList,function(l){return"dict"==t.editorType?a("el-option",{key:l,attrs:{label:l,value:l}}):e._e()})):e._e(),e._v(" "),"cascade"==t.editorType?a("el-cascader",{attrs:{size:"small",options:e.cityData()},model:{value:e.addForm[t.name],callback:function(a){e.$set(e.addForm,t.name,a)},expression:"addForm[item.name]"}}):e._e()],1)}),e._v(" "),a("el-form-item",{attrs:{label:"拥有者",prop:"ownerCname"}},[a("el-select",{attrs:{size:"small",filterable:"",clearable:"",placeholder:"请输入客户名称"},model:{value:e.addForm.ownerCname,callback:function(t){e.$set(e.addForm,"ownerCname",t)},expression:"addForm.ownerCname"}},e._l(e.allStaff,function(t){return a("el-option",{key:t.userName,attrs:{label:t.cname+"   "+t.userName,value:t.cname+"/"+t.userName}},[a("span",{staticStyle:{float:"left",width:"100px"}},[e._v(e._s(t.cname))]),e._v(" "),a("span",{staticStyle:{color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.userName))])])}))],1)],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogAddVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addSave}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"转给他人",width:"40%",visible:e.dialogTransferVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogTransferVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.formTransfer,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"新拥有者"}},[a("el-form-item",[a("el-select",{attrs:{size:"small",filterable:"",clearable:"",placeholder:"请输入员工姓名或工号"},model:{value:e.staff,callback:function(t){e.staff=t},expression:"staff"}},e._l(e.allStaff,function(t){return a("el-option",{key:t.userName,attrs:{label:t.cname+"  "+t.userName,value:t.userName}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.cname))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.userName))])])}))],1),e._v(" "),a("el-checkbox",{model:{value:e.formTransfer.checkbox1,callback:function(t){e.$set(e.formTransfer,"checkbox1",t)},expression:"formTransfer.checkbox1"}},[e._v("保留原拥有者为团队成员")])],1),e._v(" "),a("el-form-item",{attrs:{label:"转移相关业务"}},[a("el-checkbox",{model:{value:e.formTransfer.checkbox2,callback:function(t){e.$set(e.formTransfer,"checkbox2",t)},expression:"formTransfer.checkbox2"}},[e._v("线索")]),e._v(" "),a("el-checkbox",{model:{value:e.formTransfer.checkbox3,callback:function(t){e.$set(e.formTransfer,"checkbox3",t)},expression:"formTransfer.checkbox3"}},[e._v("机会")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTransferVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.turn_other_sava}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=a("VU/8")(r,o,!1,function(e){a("DlYU")},"data-v-c248cae4",null);t.default=s.exports}});
//# sourceMappingURL=10.63f46d099dc53c998e3f.js.map